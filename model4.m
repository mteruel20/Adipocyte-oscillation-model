function dydt = model4(t,x,R,noise, stimend,c)
dydt = zeros(3,1);    % a column vector

% model form taken from Ahrends et al. (2014) Science
switch c
    case 1
    if (t>=12 && t<24 || t>=36 && t<48 || t>=60 && t<72 || t>=84 && t<96 || t>=108 && t<120 || t>=132 && t<144....
        || t>=156 && t<168 || t>=180 && t<192 || t>= 204 && t<216 || t>=228 && t<240 || t>=252 && t<264 || t>=276 && t< 288 || t>=300 && t<312....
        || t>=324 && t<336 || t>=348 && t<360 || t>= 372 && t<384 || t>=396 && t< 408 || t>=420 && t< 432 ....
        || t>=444 && t< 456 || t>=468 && t< 480 || t>=492 && t< 504 || t>=516 && t< 528 || t>=540 && t< 552)
        R = 0;
    end
    case 2

    if t>= stimend
        R = 0;
    end
end

dydt(1) = 0.03 + 2*(R+x(2)).^4./(3+(R+x(2)).^4) - 0.6931*x(1);  %PPARG
dydt(2) = noise*(0.02 + 2*(x(1)*(0.2 + x(3)/(1+x(3)))).^2./(1+(x(1)*(0.2 + x(3)/(1+x(3)))).^2)) - 0.1980*x(2);  %CEBPA
dydt(3) = 0.003 + .1*(x(1)*(0.2+x(3)/(1+x(3))))^2/(.5+(x(1)*(0.2+x(3)/(1+x(3))))^2) - 0.023*x(3);   %FABP4

